arr = [87.82856074364084, 92.0121067823008, 91.62939822521298, 90.52667105432747, 90.49738875736126, 90.6901203212231, 90.67055803876511, 90.67267200486684, 90.82899309816446, 91.00343879582391, 90.82199291313165, 90.78202079499874, 90.7664923893259, 90.72439364110079, 90.7174993483884, 90.71333081218177, 90.70080457939565, 90.73480151371118, 90.70624342383475, 90.72497270136071, 90.7247142406336, 90.70450843088922, 90.72823262427605, 90.71619285030741, 90.72494668725471, 90.72559774067328, 90.71163114908961, 85.24369683676781, 81.05703318319232, 78.1973484679338, 75.76959599158944, 69.7535349620185, 66.40460461174243, 66.85183899049271, 61.52487258882651, 60.38858885482871, 60.206313375864404, 60.221374076340325, 57.22732894706379, 53.08199903841054, 54.746136837017616, 51.30524633948237, 48.92694836821626, 51.6988921731634, 53.1850292223675, 52.33556491509514, 54.66302580220518, 52.16614086586601, 48.389115984225334, 46.17097901871813, 47.43334540672545, 50.00985154760677, 51.373854687389425, 49.93587970859114, 48.89497822552084, 47.64017925891547, 44.826328975836624, 42.514829344637064, 43.8542466321286, 45.24573024848945, 47.22164440727376, 48.625146241552414, 47.41334578487609, 45.091528222831876, 42.402172138335004, 40.44997657276, 42.03380301575115, 43.841274893924194, 43.8088221543622, 44.1545420084648, 43.46694327571295, 41.40689132063847, 38.275605915303785, 36.15450771029656, 36.60843762050477, 39.24251319480917, 40.75672752919856, 40.84995520677161, 39.43667324312529, 37.15774026743516, 33.521460841021856, 31.682547541023915, 34.51088251839239, 36.62444061272075, 37.6424807653926, 37.78322384945493, 36.52258003146417, 33.68175889112969, 30.23546449353735, 28.86590332500864, 31.902029892969566, 34.59566181624888, 35.38269032022812, 34.80617126722257, 33.327739967937276, 30.165491223594337, 25.83653240533808, 26.18717356047862, 29.190323754875568, 31.45347606900887]  
using QuadGK
using ControlSystems
using DSP
using Plots


arr_2 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00148759948521979, 0.0029101956453314983, -0.041414106159986766, -0.08392878503645676, -0.05334018241869491, -0.018871802836487844, 0.06709488336265024, 0.1406861348833427, 0.13502296773551364, 0.11973477373030444, 0.11742148448917267, 0.15484682007990097, 0.16702004109812646, 0.1336746671621419, 0.0778973348591041, 0.03338939690853538, 0.0060322428627585245, -0.03542483764603277, -0.10362968256906459, -0.15912707856575872, -0.1907398513466774, -0.22606704371634562, -0.26065765092388793, -0.27166191482851454, -0.2672901934380819, -0.25438750934131343, -0.22873145805806905, -0.19668816952970083, -0.15921517727817275, -0.12026744353037436, -0.07472377942392697, -0.05006325786707411, -0.027593574885517703, 0.011022490376964825, 0.06342465127998681, 0.13321748464256222, 0.1940286023922529, 0.2685392938890393, 0.32421460968653104, 0.35390810842869885, 0.36360378842521196, 0.35070498204667994, 0.3271824815922316, 0.29104009377351914, 0.25783796292526734, 0.20877021775739274, 0.14071135075668226, 0.07586023983194669, 0.014302445454865309, -0.038728860991726934, -0.08669307503915746, 
-0.1420811148526488, -0.19874776847252945, -0.2686022293125687, -0.33779713313981513, -0.4092676091244247, -0.4592224501876006, -0.49088520260869833, -0.4793518292993666, -0.42140357231823844, -0.33176523717636064, -0.21767636126311674, -0.11562675069674645, -0.04113016053536629, 0.0032169382022085484, 0.04774604793105415, 0.09054791987896094, 0.15623680596358175, 0.23477802213473067, 0.3205261441471008, 0.391625959873351, 0.4330018276135828, 0.44978166801151237, 0.45662242580108453, 0.4572379175997657, 0.44116230706315257, 0.4002630366742852, 0.3493908064649838, 0.29296630009766783, 0.21270831848493513, 0.12703762560583248, 0.02919878637319569, -0.11628642795284624, -0.25121678581886836, -0.34818238777163574, -0.44615535921831917, -0.5308180148196586, -0.5791980998663622, -0.5888766110449384, -0.5622695620147061, -0.5126248059469669, -0.4552322034230806, -0.3729392997447192, -0.26058771012285914, -0.11937408913424286, 0.019227360587390958, 0.16262952669262615, 0.3030050910557055, 0.4305185675485584, 0.5309101341907769, 0.606910895759639, 0.6493149293523124, 0.6621037452924028, 0.6468166778988429, 0.5900541408967888, 0.4875065936619194, 0.3607534437803049, 0.22040571637323794, 0.07859262826008752, -0.05978512103465564, -0.1786657843817221, -0.28515728592211637, -0.3888928543208595, -0.45658885789564124, -0.5013500907388226, -0.5212935349289829, -0.5296185440512137, -0.5225329634729431, -0.49628011443918896, -0.4615900600740335, -0.4178449844224166, -0.3585825723726396, -0.2760976520946905, -0.17562986189028745, -0.07235699380261675, 0.04515916789763948, 0.1710760122373039, 0.2837805691257127, 0.3731535962823723, 0.4352286567408946, 0.4874092035318107, 
0.512673584047447, 0.5055971260866791, 0.47545312944839613, 0.41864456208536904, 0.349931969383466, 0.277453179280296, 0.19252277721070282, 0.10649110167832135, 0.015478982982291074, -0.06498866593726058, -0.1398300495525241, -0.23019462892263204, -0.3040364394799198, -0.3775933147688795, -0.44491301285397, -0.48850768934630695, -0.5056430413138463, -0.5040709072463945, -0.47814750094492964, -0.4128352450523727, -0.3277733817334225, -0.23612580718791956, -0.13357365957580936, -0.04153928117459721, 0.049608000939480035, 0.14206976839066454, 0.227883575886613, 0.30844630156980385, 0.3826746105808384, 0.4474215830413016, 0.49188652702115254, 0.5195882327054363, 0.5178304335111191, 0.4909709027186663, 0.432869721914088, 0.35131374253338016, 0.272712791666839, 0.17329681284788362, 0.07039439917191, -0.02241363418603361, -0.12835592796716278, -0.2334894149023239, -0.3218629691667847, -0.40508572502482504, -0.47244196929496046, -0.5120661605675259, -0.5299460729243466, -0.5287233603670023, -0.4993691782748955, -0.45011612777304283, -0.37198089949665336, -0.2799524403816911, -0.16908613149111365, -0.03497531955470027, 0.10262019780035166, 0.2409956716752736, 0.372239664436265, 0.4895912717698434, 0.5726346680391889, 0.6304370371991931, 0.6536222055249344, 0.6519079262718714, 0.629648133771554, 0.576770147325807, 0.49851258946535415, 0.40263250459183875, 0.28230697523698167, 0.1486198548545148, 0.0003140875406570561, -0.15147236245693166, -0.30064292933781234, -0.44155284654519156, -0.5596497106215097, -0.6516713769964257, -0.7110146840093045, -0.737518483777906, -0.7397304474499028, -0.7081170350115817, -0.6430751992399256, -0.5570204818917127, -0.45464533596733403, -0.33406280832287405, -0.19961423617199228, -0.06622470208146691, 0.06311793680784991, 0.1884255728785761, 0.3125185708812575, 0.43394359004837546, 0.5332272416641837, 0.6028582788417783, 0.6416536947172304, 0.6512483297910865, 0.6332537824472306, 0.5939980129671361, 0.5358544840547605, 0.4561675986111758, 0.3555313951502067, 0.23744523524092442, 0.10265402359506881, -0.038824937118446014, -0.18094956160616443, -0.3100379505709756, -0.4147857404622354, -0.49406230051482103, -0.5565007378889112, -0.5972807364470512, -0.6179636434762523, -0.6148514305049948, -0.5785920727499725, -0.5161358207132808, -0.4227787182521723, -0.3060285634780017, -0.17538512418499974, -0.03964538982465352, 0.10130905642654117, 0.23347609911684225, 0.3593542311104424, 0.47300580121616803, 0.5661642784601257, 0.6258356325641256, 0.6483591203372767, 0.6497980280605709, 0.629160931314051, 0.5848719772598286, 0.5176919971971601, 0.43013535860045954, 0.32710178872237816, 0.2083171561106875, 0.0817025035836304, -0.05586754108000265, -0.19416972315951087, -0.321409934404438, -0.42818843079295094, -0.5216309487740126, -0.593713166768748, -0.6425020736039826, -0.6631946057918673, -0.6590688992208237, -0.6250710827740805, -0.5599270330646966, -0.4667971026168661, -0.3487228801493548, -0.21916702080645295, -0.07838748285124245, 0.06615006308492484, 0.20906842779891358, 0.3475795191116383, 0.46731752824657946, 0.5606671677038728, 0.6249350401780025, 0.6607607312673056, 0.6729192140528217, 0.6489560825334892, 0.5913468154787982, 0.5105329156869465, 0.4056817085669185, 0.27866024536013356, 0.13694242997882583, -0.012395739079523219, -0.15587879388200399, -0.28816108297680365, -0.4063244617740339, -0.515853230311969, -0.6038656814358858, -0.659489487014383, -0.6849974840875093, -0.6780591739883168, -0.6416966027879115, -0.5798024296411701, -0.498395085235513, -0.3940765146636944, -0.2700006088683188, -0.14360309577812064, -0.014770092581854688, 0.11612258527994565, 0.24481363383406152, 0.3588026279181442, 0.46163851089861807, 0.5470669964104325, 0.6070315072802394, 0.6399497884438297, 0.6483631860208019, 0.6298531325549863, 0.5847890068842125, 0.5164900085531653, 0.4211771636358189, 0.3050556371007531, 0.18458218427957576, 0.06085316604209804, -0.0691220592534719, -0.1983267722876917, -0.3101168915402033, -0.401594533659518, -0.47560759078080245, -0.5250973266514349, -0.5512515039430784, -0.5540246798465833, -0.5350268089451733, -0.4930069240304065, -0.4361335020328898, -0.3605270132633053, -0.2633096101976306, -0.15929628411471308, -0.054437904552470585, 0.05365764722527623, 0.16010468874568806, 0.25287946795572463, 0.3377505234249157, 0.41422999878007805, 0.4671878001573462, 0.5025767584728928, 0.5235467599077357, 0.5250330352588077, 0.5024296452723293, 0.4623133305064249, 0.4034938741019923, 0.3183053483478522, 0.21680584355422675, 0.10957289946595623, -0.0037635379998517404, -0.11972912279331716, -0.23313764988108737, -0.3374008104388962, -0.4308116756218632, -0.5049696071881461, -0.5602689636269065, -0.5951138589065157, -0.6028756937958402, -0.5863708804763679, -0.5492670320793303, -0.4876906188343153, -0.4022689164182117, -0.30096323216337195, -0.18984281113231094, -0.06814606052057226, 0.05943780135596201, 0.18348220295435708, 0.3022089745343278, 0.4129282857988981, 0.5061854818979559, 0.5792648292491062, 0.6295318153004633, 
0.6521489309547814, 0.6423999314046769, 0.6015483570698321, 0.5330325508762499, 0.4393875066137859, 0.323054402226182, 0.18765475392193376, 0.04525818363306329, -0.10344324864136364, -0.24887136336411675, -0.3806897798669291, -0.49208217560259293, -0.5794660960178266, -0.638192160414433, -0.6667654007654216, -0.6621316130791485, -0.6272257381533639, -0.565504963005131, -0.4763637208387302, -0.3652580881234333, -0.23393300400112366, -0.09240600609230261, 0.05105287116362246, 0.19453225374861804, 0.32774886860168656, 0.4453160335901233, 0.5466082734046845, 0.6209610546617267, 0.6605884559202013, 0.6744651583072897, 0.6596370404235498, 0.613757814235889, 0.5398849039643452, 0.4454466560109938, 0.33273079899373514, 0.20118101286141005, 0.06344489161587197, -0.07463269253188667, -0.2116032009106844, -0.3368588705710248, -0.44288680270712355, -0.5307866102373877, -0.5925248102974574, -0.6267184080992838, -0.6381510483630731, -0.6245864830315401, -0.5839886071558859, -0.5170704326676017, -0.4309419752816315, -0.32402516315083263, -0.20246891554843405, -0.07755590499471823, 0.05177771584751811, 0.17893739865377922, 0.2947249619868464, 0.3959250552388671, 0.485294071645672, 0.5520292595409073, 0.5929094527605028, 0.6072873801865484, 0.5950286905434861, 0.555894191876022, 0.4904620810604586, 0.40471755956322736, 0.299997907301744, 0.18332617913382593, 0.0620785082605458, -0.06242703876655649, -0.18475294158165217, -0.2975976670856775, -0.3973180708879298, -0.4781743059887773, -0.5374340233101912, 
-0.5753488890641187, -0.5895197060419786, -0.5766584803538886, -0.5367843848317887, -0.4765703418115238, -0.3957085863380764, -0.2947470818709326, -0.18030023040971432, -0.05765766756725713, 0.06970917708911695, 0.19516015542423437, 0.3094090302018443, 0.40980421421713953, 0.4929376565687347, 0.5509829586780921, 0.5851500285811956, 0.5997087035560886, 0.5885226401549944, 0.5502019112614486, 0.4895225221865332, 0.41003079176916657, 0.310314082256946, 0.19616803216577333, 0.07431289303600803, -0.053431506466979875, -0.18087564392681202, -0.299262131136594, -0.4048936480405965, -0.493770982850244, -0.5597018538437193, -0.6006695726891227, -0.6168764109137609, -0.6062924253213011, -0.5682631776397228, -0.5036931053944866, -0.4158986359593915, -0.3110525943853145, -0.19274308601570636, -0.0645106511083638, 0.06618678797691897, 0.1919776352242565, 0.3082944124766978, 0.40916699200711903, 0.4891470587596634, 0.5484470785092947, 0.5842897784200374, 0.5928466605737308, 0.5745492639068184, 0.5317321268815398, 0.46723386401462363, 0.3838222902271904, 0.28442992618250784, 0.1718631180522175, 0.054121936030266195, -0.06345255526779361, -0.17916274500934995, -0.28838718200190094, -0.38648176908761267, -0.47005359906780864, -0.5366665420880751, -0.5788812648131995, -0.5982808295800249, -0.5962786683233385, -0.5669855188231525, -0.5088249990435526, -0.4278337521596236, -0.3296022069403529, -0.21426693483184459, -0.08875396461983298, 0.040879995991047705, 0.17020336324957458, 0.2931390633047629, 0.40207428797715733, 0.4940392488394242, 0.5638957458252545, 0.6066077787909043, 0.6227782380777693, 0.6119984141733024, 0.5724805566168503, 0.5070409751426908, 0.42121451975512453, 0.3171657356846458, 0.19877622573172574, 0.07335402804777894, -0.05426506500629513, -0.17982011072080573, -0.29577741466123764, -0.3979029126434398, -0.48429417595510993, -0.5487046703427935, -0.5877481951516372, -0.6027297854430089, -0.5919997694898381, -0.5534359634262396, -0.49091950027895814, -0.4085849904321293, -0.3058158376674806, -0.1879114453604739, -0.06388043590736772, 0.06232743927287439, 0.18555953011810955, 0.29960018844023073, 0.4012497081290999, 0.4865749762915105, 0.5496008851921014, 0.5876073791702856, 0.6015338285020994, 0.5882377003167845, 0.5457684800634184, 0.478104074170108, 0.3906252202657161, 0.28544656478040586, 0.16703479652448033, 0.041153208497366735, -0.08565771370054417, -0.20894013517741286, -0.32348947145078144, -0.4239805172233997, -0.5071290429330458, -0.5670905313763682, -0.6020151277901945, -0.6119352037020809, -0.5944187072099318, -0.550894024484462, -0.4839558401088003, -0.39380476123450503, -0.2852080643615651, -0.16498261959765104, -0.03670594356523486, 0.09435127575100323, 0.2201961550695148, 0.3371562849560144, 0.4410770019181394, 0.5251662215204258, 0.5855476450051356, 0.6212107387613861, 0.630685404977462, 0.6121704957710203, 0.5671079922824972, 0.4989931341498071, 0.4094639106779029, 0.301117586359785, 0.1802241387749398, 0.05174650914504234, -0.08018943590426832, -0.20952530182656393, -0.3292857224160797, -0.4344107157295434, -0.5219482235955086, -0.5873453027289407, -0.626264397216828, -0.6373036960428327, -0.6213488940160832, -0.5786094545954034, -0.5108994775474913, -0.42072277467764524, -0.3123038712974827, -0.19093374540333624, -0.0609209666476083, 0.07277034951126223, 0.2015420740666008, 0.3205100793513038, 0.42783018072710927, 0.5163628506044524, 0.5808600128797777, 0.6211036041669966, 0.6355617186500784, 0.6205432125720434, 0.5775214834098666, 0.5097961715499819, 0.4184041286111982, 0.30763762365204483, 0.18407059304919296, 0.05193568711260162, -0.08318410041281717, -0.21368808463097444, -0.33512216344691353, -0.4422796775755154, -0.5281116334980898, -0.5898744926425783, -0.6266548300625012, -0.6360874582243358, -0.6174009665421842, -0.5737102506788427, -0.5046471984462382, -0.4123529720507463, -0.30311709606581877, -0.18044986466742102, -0.049530331905546676, 0.08260254764958476, 0.21096526630624096, 0.33116965348688576, 0.4357442692076546, 0.5207902290006976, 0.5844407594689227, 0.6232700172150313, 0.6339805475074667, 0.6169381166471326, 0.5726565476299985, 0.5025368837528974, 0.4108926943492379, 0.3010646941073595, 0.17725456155739508, 0.04559371061381545, -0.08709853904224027, -0.21650762872323573, -0.3352982952461242, -0.4384650315761416, -0.523885553032779, -0.5841603731553615, -0.6163577355571708, -0.6235314649606436, -0.6035865243125709, -0.5547433920008663, -0.4841946477723152, -0.39547886688996015, -0.2866565428157887, -0.16567819886162463, -0.04144813389319472, 0.08594255930016007, 0.2122459434376021, 0.3270784095019922, 0.4273765200892304, 0.511471092021991, 0.5720109339480433, 0.6056345867387796, 
0.6147680665217798, 0.5976562316244198, 0.5528777384102063, 0.4846351454225216, 0.39566992084420394, 0.28885345729787604, 0.16966234276525508, 0.0430810024816833, -0.08670905404635387, -0.21208641828365582, -0.3272522794334939, -0.4292518053840786, -0.5130613797390097, -0.5741123936375656, -0.6114648652866981, -0.6235625247023193, -0.6086780077852462, -0.5679967996616349, -0.5035483001899983, -0.41600837037592503, -0.30998180606824044, -0.19164184608709203, -0.06426018871556408, 0.0669875600498729, 
0.1942230455752958, 0.31288622444459896, 0.4195637851228087, 0.5081838126811319, 0.574466895583926, 0.6163738807072379, 0.6325882514173018, 0.6213914071441333, 0.5829272659968776, 0.5196699857997882, 0.4344854912709186, 0.3292794786806328, 0.20856487519399214, 0.07920380133154617, -0.054067949305961996, -0.18693644841485607, -0.3112747440198524, -0.4209190428403262, -0.5134053074302065, -0.5837479673796261, -0.6271905548818777, -0.6439028725761302, -0.6340450451757932, -0.5949905673132225, -0.5282839859343711, -0.4395846226300496, -0.33185053750623406, -0.2077892588008301, -0.07551709072751023, 0.05900868528728207, 0.19290897045042477, 0.31860490393211716, 0.4287895305555732, 0.5214800761397683, 0.592157214813829, 0.6349336795917555, 0.6492696027976552, 0.6363254873898404, 0.595014058287479, 0.5265053883892138, 0.4351511131547466, 0.3245413343864978, 0.19915180683850933, 0.06520558764818962, -0.07176612190770851, -0.20625021078662137, -0.3308662685868142, -0.4398533166504036, -0.5307166596034834, -0.599460967486881, -0.6406527239070499, -0.6533813609592685, -0.6385719463937962, -0.5955538486955454, -0.5258679622448234, -0.43351024478860134, -0.3218599687054386, -0.19570298974517744, -0.061395380786343545, 0.07615294545013074, 0.2101889105292967, 0.33308976053275574, 0.44139733416726346, 0.5315056071702223, 0.5963780475816188, 0.6335152893957977, 0.644744031497932, 0.6284565943275242, 0.5835970066820843, 0.514377278869879, 0.4239479931901192, 0.3140985008044367, 0.19051156787215318, 0.05984458061316063, -0.07305669471833812, -0.2026630752692783, -0.32246045135428586, -0.42853977825282846, -0.5164150717345004, -0.5808528409890144, -0.6202523463014195, -0.6339013979068884, -0.619109304244037, -0.57737771451104, -0.5120473095998817, -0.4233749508460863, -0.3151077808176513, -0.19469315796653697, -0.06583764051544563, 0.06786723884316699, 0.19793632579533396, 0.31782183301411515, 0.42478532808967967, 0.5135317925476008, 0.5785711960188602, 0.6193199425951783, 0.6338718979296356, 0.6186632944338212, 0.5761682689007885, 0.5104068452439808, 0.4213698309543298, 0.31257599388717255, 0.19166577690864608, 0.06250628582002356, -0.07057087026760034, -0.19955140046747105, -0.31943612746711403, -0.4274220660070813, -0.5171089077394857, -0.5829048533209296, -0.6243847040079897, -0.6401126685184275, -0.627333922667177, -0.5873179475905492, -0.522596908139257, -0.4343968690059297, -0.3270148604069518, -0.20662032755744336, -0.07751743321335303, 0.05563576422070804, 0.18556978869694962, 0.3067342010205018, 0.4152002025710491, 0.5050406917098216, 0.5723934008587745, 0.6158006448475364, 0.6328218356590316, 0.6223257515197558, 0.5853151469376716, 0.5225988997656901, 0.43617294644844257, 0.33068258508515785, 0.21147990361697333, 0.08329270709420296, -0.04915369800263351, -0.17941065404556455, -0.30071542575714094, -0.4085295106094282, -0.49944275787712544, -0.5687195929275601, -0.6123140958283759, -0.6296664710224837, -0.6199806781469994, -0.5816246966512651, -0.5174957027480951, -0.4321098708717395, -0.32702103720214093, -0.2061739648117821, -0.07745585576000483, 0.054198508596809414, 0.1845991628917139, 0.3060778730859542, 0.41346714046264366, 0.5044977554975816, 0.5733932602752261, 0.6156008453188728, 0.6317494922557418, 0.620531950012192, 0.5806447937434536, 0.5163450188420533, 0.43036247088914215, 0.3229750261016213, 
0.2014055436471948, 0.0736625543269952, -0.05832594520751855, -0.1894326825424564, -0.31056515040221644, -0.4186064651273887, -0.5103902418074471, -0.5780458924562193, 
-0.619882088544127, -0.6374143052111878, -0.6266158075192005, -0.5867426152998378, -0.5228252809393419, -0.4362159554679875, -0.32877926824065007, -0.20839311579446895, -0.08019613102773566, 0.053578834211350526, 0.18483460817030384, 0.30582584486765274, 0.4149467999298018, 0.5071842347516974, 0.5748478292285062, 0.6176330900619108, 0.6353921122247793, 0.6232515840164512, 0.5826758128124939, 0.5188807555590949, 0.4316379614901518, 0.32311547547385683, 0.20181955169453747, 0.07262963254136663, -0.06172155987475073, -0.19301388217134446, -0.31394150677596466, -0.42218260751356695, -0.5126084289464171, -0.5787536777586427, -0.6197406342808263, -0.6352118155113375, -0.621698086652728, -0.5800095951586782, -0.5145851852267534, -0.42660260226239416, -0.3187203879458578, -0.19819064305216944, -0.06976313895726186, 0.06328573836582432, 
0.1930652212593031, 0.31309457544103725, 0.4208063204552409, 0.5111554737910008, 0.5778500228784094, 0.6194966877426246, 0.6356997246387373, 0.62339379028621, 0.5831251160145955, 0.5189872048217162, 0.4320686933753406, 0.3245888362748561, 0.20396393671678706, 0.07537051712013354, -0.057713345400118445, -0.18779133744191326, -0.3087068222330145, -0.4175568545080588, -0.5083235683366056, -0.5753269305988427, -0.617855224127989, -0.6344146905888928, -0.622384446270612, -0.583134605822387, -0.5190053855729241, -0.431500580026857, -0.32543002160207096, -0.20674686059877048, -0.07889930014306741, 0.052854079824831826, 0.18123785628745825, 0.301398529408764, 0.4087809026441691, 0.49747791206592407, 0.5643244751269622, 0.6073861489047626, 0.6231180470645327, 0.6104854409352118, 0.5717378532458575, 0.5082830788344503, 0.4222809168812651, 0.31789258030520046, 0.1989987561764619, 0.07116541190474415, -0.058548987350420335, -0.18580675761194343, -0.30639353053908647, -0.4131121075197344, -0.5010543814374168, -0.5679209754137376, -0.609483933614287, -0.6233949323490012, -0.6113449569512605, -0.5727194180526469, -0.5073236291047989, -0.42045795240463885, -0.3162367731135516, -0.19666305569079318, -0.06852540412920252, 0.061119764454389894, 0.18929571229142675, 0.31037453145536753, 0.4162528817611779, 0.503638781423217, 0.5703883258787164, 0.6115292017531486, 0.6252252244533685, 0.6126951972190092, 0.5730519183607884, 0.5073566516938182, 0.4206540132436919, 0.3155811684148547, 0.1950686554530363, 0.06679845055457403, -0.06331669139476578, -0.19200437364992154, -0.3122708827691699, -0.41762411353997947, -0.5058792680403528, -0.5726391351179259, -0.6129951565818691, -0.6270516197470691, -0.6146110961683371, -0.5740927168611514, -0.5085674629774873, -0.42209426405804923, -0.31635511828182805, -0.19638835092695142, -0.06953881264203146, 0.060682473397947446, 0.18957671893089378, 0.30867200433686975, 0.41354155042165963, 0.5019473977096875, 0.5678580107683071, 0.6078888146876209, 0.6228974549096518, 0.6107153394206377, 0.5704002514367325, 0.5063493306787716, 0.42089983852157253, 0.3153966917778142, 0.19662436131574326, 0.07048211914834608, -0.06002928661917539, -0.18806967034482536, -0.3066237471383647, -0.41296842578253723, -0.5021259866211261, -0.5677828058483307, -0.6090325408554842, -0.6251914485596308, -0.6127666733744399, -0.5730588553752161, -0.5100822401467273, -0.42413845803060857, -0.3182666049192244, -0.19997587054092353, -0.07322217002905647, 0.05828088134094557, 0.18653331217602703, 0.3058398845261431, 0.4129645512742539, 0.5018671272773377, 0.5678221490354087, 0.6097446224354213, 0.6253121667155515, 0.6127656427920263, 0.5739976409653562, 0.5105969420820887, 0.4238526024359681, 0.3187949437507728, 0.20089363175865851, 0.07342288953795187, -0.05804569329439779, -0.18595513319297144, -0.30570846432655363, -0.4131775597849517, -0.5021460608903022, -0.568785894124235, -0.6115697841245218, -0.6275033705261778, -0.6150815647641199, -0.5764877494111715, -0.5134544193534322, -0.42703486913735733, -0.32156170826534036, -0.2028027937349412, -0.0749978714993618, 0.056254244075367166, 0.18407118052558508, 0.3040436361462622, 0.41178518233234024, 0.5006165800266631, 0.5663639412026182, 0.6080508761523795, 0.6234133173700809, 0.6105839971744462, 0.571198596093559, 0.5070766853143792, 0.4196158318915189, 0.3136834693398536, 0.1951124551691144, 0.06739484469847459, -0.06432278049077786, -0.1923677072027487, -0.31172689939659637, -0.4185570218095936, -0.5065891722752811, -0.5716735023338961, -0.6128205995908509, -0.627269715453036, -0.6130619932976309, -0.5724251893486962, -0.5073327561205727, -0.4192893867216687, -0.3130350387427226, -0.19353334991828666, -0.06472485515496991, 0.06691956506563743, 0.1946775863784054, 0.31447103603840465, 0.42119856091368657, 0.5086917996747926, 0.5740411575219594, 0.6151786550743608, 0.6285906469704743, 0.6140341979356082, 0.5739693446721267, 0.5086780815098341, 0.4200213638401915, 0.3137846713791669, 0.19442731732241136, 0.06574032027855448, -0.06550567017076361, -0.19327967931176485, -0.31340446382948406, -0.41987868515489524, -0.5070104222554344, -0.5723099913122958, -0.6134304874781635, -0.627370195555239, 
-0.6136606813403136, -0.5737123936850468, -0.508633770263149, -0.42092138272870444, -0.31532042067450405, -0.19618404217802138, -0.06790118988131158, 0.06301589337199534, 0.19026284570140453, 0.30947711132159383, 0.41551386929699735, 0.5027677514021787, 0.5679208211595215, 0.6084259452330518, 0.6217139927462603, 0.6076905482383425, 0.5678841202445416, 0.5029740024473752, 0.4150759142890449, 0.30926608489068896, 0.1903588211228453, 0.06262051200135058, -0.06774641180423886, -0.19488206733744484, -0.3144304988168992, -0.420293874090534, -0.5067734924819064, -0.5717313325370013, -0.6126271978611363, -0.6260482442110802, -0.6121894346534362, -0.5724170487362519, -0.50686861913704, -0.41890956984533767, -0.3140876804165332, -0.19526383819644047, -0.06666674792722385, 0.06393451444501463, 0.19127989565385606, 0.3115179293397133, 0.41775738590837186, 0.505003713960113, 0.5714738873798411, 0.6129902570418527, 0.6263195881320285, 0.6131385616685683, 0.5741117307452179, 0.5088173933411904, 0.42130188829587756, 0.31614245921388995, 0.19609815076050735, 0.06747447813533188, -0.06253469750626839, -0.19049410103644693, -0.31122349942082395, -0.41719623100981806, -0.5047450334257495, -0.5712085648039253, -0.6117994749393352, -0.62523355485734, -0.612759414975386, -0.5730273970856223, -0.5069245483282843, -0.419778234870168, -0.3147652713720968, -0.19462432598535107, -0.06647926805543283, 0.0635794586653228, 0.192063102409669, 0.31233925173320864, 0.41752985021655126, 0.5050152486871623, 0.5713400454162356, 0.6114180874818109, 0.6244874146853556, 0.6115799674021628]

function time_weighted_sound_level_t(pressure_data::Array{Float64}, reference_pressure::Float64)
    # Set up constants according to IEC 61672-1
    t1 = 0.125  # Time constant for fast weighting (s)
    t2 = 1.0    # Time constant for slow weighting (s)
    k = 1.0     # Factor for combining fast and slow weightings

    # Initialize variables
    Lp_fast = zeros(length(pressure_data))
    Lp_slow = zeros(length(pressure_data))
    Lp_time_weighted = zeros(length(pressure_data))

    # Calculate sound pressure level for each sample using fast weighting
    for i in 1:length(pressure_data)
        Lp_fast[i] = 20 * log10(abs(pressure_data[i]) / reference_pressure) + 2.0
    end

    # Calculate sound pressure level for each sample using slow weighting
    for i in 1:length(pressure_data)
        if i == 1
            Lp_slow[i] = Lp_fast[i]
        else
            Lp_slow[i] = k * Lp_slow[i-1] + (1-k) * Lp_fast[i]
        end
    end

    # Calculate time-weighted sound level using the calculated sound pressure levels
    for i in 1:length(pressure_data)
        Lp_time_weighted[i] = 20 * log10(sqrt(sum(pressure_data[1:i].^2)/i) / reference_pressure)
    end

    return Lp_time_weighted
end


function array_integral(arr::Array{Float64}, start_value::Float64, end_value::Float64, exp)
    # Calculate the width of each trapezoid
    h = (end_value - start_value) / (length(arr) - 1)

    # Initialize variables
    integral = 0.0
    prev_val = 0.0

    # Use the trapezoidal rule to calculate the integral
    for val in arr
        integral += (val + prev_val) / 2.0 * h* exp(-(i))
        prev_val = val
    end

    return integral
end

function integrate(data::AbstractArray{Float64,1}, sample_frequency, integration_time)
    #integration_time = convert(T, integration_time)
    #sample_frequency = convert(T, sample_frequency)
    samples = size(data, ndims(data))
    b, a = tf([1.0], [1.0, integration_time], [1.0])
    b, a = bilinear(b, a, fs=sample_frequency)
    # b, a = bilinear([1.0], [1.0, integration_time], fs=sample_frequency) # Bilinear: Analog to Digital filter.
    n = convert(Int, floor(integration_time * sample_frequency))
    data = data[:, 1:n * (samples ÷ n)]
    newshape = [size(data, i) for i in 1:ndims(data)-1]... , -1, n
    data = reshape(data, newshape)
    # data = reshape(data, (-1, n)) # Divide in chunks over which to perform the integration.
    result = lfilter(b, a, data, dims=2)[:, end] / integration_time
    return result
end

function time_weighted_sound_level(pressure, sample_frequency, integration_time, reference_pressure=REFERENCE_PRESSURE)
    """Time-weighted sound pressure level.
    :param pressure: Dynamic pressure.
    :param sample_frequency: Sample frequency.
    :param integration_time: Integration time.
    :param reference_pressure: Reference pressure.
    """
    levels = 10.0 * log10.(integrate(pressure.^2.0, sample_frequency, integration_time) ./ reference_pressure^2.0)
    times = collect(0:levels[end]/(length(levels)-1):levels[end])
    return times, levels
end



#time, lp = time_weighted_sound_level(arr_2, 3000.0, length(arr_2 / 3000.0),5*10^(-5))
 
#display(plot(time, lp))


test_arr = [0,1,2,3,4,10,20,40,43,41,39,20,10,0]

println(findfirst(diff(test_arr) .<= -5))


A = [1,2]
B = [3,4]
C = [5,6]

D = cat(A,B,C,dims=3)

AB = rand(1:9, 3, 4, 5)

A = ([1,2],
[2,3],
[4,5])


println(A)

Δd = 0.1

r = 0.54

typeof(div(r,Δd))